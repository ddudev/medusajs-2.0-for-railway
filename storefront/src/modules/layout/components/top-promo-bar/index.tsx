"use client"

import Image from "next/image"
import LocalizedClientLink from "@modules/common/components/localized-client-link"
import SearchBar from "@modules/layout/components/main-header/search-bar"
import AccountLink from "@modules/layout/components/main-header/account-link"
import CartButton from "@modules/layout/components/cart-button"
import { HttpTypes } from "@medusajs/types"

import MobileMenu from "@modules/layout/components/mobile-menu"

type TopHeaderProps = {
  categories?: HttpTypes.StoreProductCategory[]
}

const TopHeader = ({ categories = [] }: TopHeaderProps) => {
  return (
    <div className="w-full bg-white h-[64px] md:h-[84px] border-b border-gray-100 md:border-none shadow-[0_4px_20px_rgba(0,0,0,0.08)] z-[100] sticky top-0">
      <div className="content-container h-full">
        <div className="flex items-center gap-2 md:gap-4 h-full relative max-w-full">

          {/* Mobile Only: Left Hamburger Menu */}
          <div className="flex md:hidden items-center mr-auto">
            <MobileMenu regions={[]} categories={categories} />
          </div>

          {/* Logo - Centered on mobile, Left on desktop */}
          <div className="flex-1 max-w-[44px] lg:max-w-[150px] order-first">
            <LocalizedClientLink
              href="/"
              className="flex items-center"
              data-testid="nav-store-link"
            >
              <svg
                width="1903"
                height="481"
                viewBox="0 0 1903 481"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
                className="block hidden lg:block"
                style={{ height: "auto", width: "150px", minHeight: "32px", minWidth: "120px" }}
              >
                <path d="M0 228.814C0 120.95 0 67.0179 33.509 33.509C67.0179 0 120.95 0 228.814 0H311.186C419.05 0 472.982 0 506.491 33.509C540 67.0179 540 120.95 540 228.814V251.859C540 359.723 540 413.655 506.491 447.164C472.982 480.673 419.05 480.673 311.186 480.673H228.814C120.95 480.673 67.0179 480.673 33.509 447.164C0 413.655 0 359.723 0 251.859V228.814Z" fill="#EB7310" />
                <path d="M444.493 204.15C471.921 218.333 412.455 291.218 332.081 341.928C316.935 351.483 317.121 353.021 333.292 351.975C367.639 349.754 404.545 337.826 432.827 319.805C443.332 313.112 446.739 312.392 450.433 316.086C460.263 325.917 433.217 353.177 395.863 371.085C304.494 414.892 160.711 390.675 244.488 345.59C260.076 337.201 275.943 328.311 282.742 324.157C318.473 302.327 349.827 279.248 347.252 276.672C346.878 276.298 339.566 277.333 331.002 278.974C269.122 290.824 204.71 287.661 151.457 270.157C103.387 254.358 80.6516 234.999 90.7384 218.457C96.699 208.681 107.317 208.735 128.607 218.651C210.62 256.846 315.981 255.128 404.842 214.144C431.717 201.749 437.185 200.371 444.493 204.15Z" fill="white" />
                <path d="M374.76 89.5176C409.688 105.472 401.83 182.902 365.284 182.902C351.259 182.902 340.162 172.247 334.984 153.808C324.211 115.445 347.856 77.2284 374.76 89.5176Z" fill="white" />
                <path d="M193.154 90.0988C221.956 103.512 223.272 165.23 195.075 180.09C172.906 191.773 150.164 168.95 150.164 135.02C150.164 102.189 171.421 79.978 193.154 90.0988Z" fill="white" />
                <path d="M1833.47 173.858H1903V343.655C1903 422.229 1858.44 459.408 1780.85 459.408C1750.74 459.408 1721.72 454.182 1698.4 443.894C1685.82 438.347 1682.24 423.119 1688.58 410.927C1696.58 395.539 1717.15 391.06 1733.59 396.587C1746.72 401.001 1761.08 403.448 1774.32 403.448C1813.5 403.448 1830.02 385.817 1830.02 353.237V346.338C1815.81 362.819 1794.68 370.868 1768.18 370.868C1712.86 370.868 1666 331.773 1666 270.447C1666 209.504 1712.86 170.408 1768.18 170.408C1796.98 170.408 1819.26 179.607 1833.47 199.155V173.858ZM1785.46 312.992C1811.58 312.992 1830.79 295.744 1830.79 270.447C1830.79 245.15 1811.58 228.285 1785.46 228.285C1759.34 228.285 1739.75 245.15 1739.75 270.447C1739.75 295.744 1759.34 312.992 1785.46 312.992Z" fill="#1A1A1A" />
                <path d="M1542.89 169.909C1599.32 169.909 1645 211.085 1645 277.274C1645 343.848 1599.32 385.408 1542.89 385.408C1515.64 385.408 1495.3 377.712 1481.48 361.165V381.945H1412V132.874C1412 112.735 1428.33 96.4082 1448.47 96.4082C1468.61 96.4082 1484.93 112.735 1484.93 132.874V191.459C1499.14 176.836 1518.71 169.909 1542.89 169.909ZM1527.54 327.3C1552.11 327.3 1571.3 309.214 1571.3 277.274C1571.3 245.718 1552.11 228.017 1527.54 228.017C1502.97 228.017 1483.78 245.718 1483.78 277.274C1483.78 309.214 1502.97 327.3 1527.54 327.3Z" fill="#1A1A1A" />
                <path d="M1256.78 326.914H1329.75C1344.8 326.914 1357 339.113 1357 354.161C1357 369.209 1344.8 381.408 1329.75 381.408H1196.29C1179.01 381.408 1165 367.401 1165 350.122C1165 342.58 1167.72 335.292 1172.67 329.599L1261.38 227.519H1194.74C1179.8 227.519 1167.69 215.406 1167.69 200.464C1167.69 185.521 1179.8 173.408 1194.74 173.408H1322.15C1339.28 173.408 1353.16 187.291 1353.16 204.415C1353.16 211.89 1350.46 219.113 1345.56 224.755L1256.78 326.914Z" fill="#EB7310" />
                <path d="M1144 278.292C1144 288.47 1134.94 296.337 1124.76 296.337H991.412C997.561 317.453 1015.63 329.739 1042.53 329.739C1051.81 329.739 1059.65 328.544 1066.79 326.082C1081.62 320.964 1099.1 320.547 1109.98 331.85C1120.71 342.996 1121.19 361.06 1107.96 369.072C1090.11 379.878 1067.66 385.408 1040.22 385.408C966.044 385.408 918 339.721 918 277.524C918 214.944 966.813 170.408 1032.54 170.408C1094.03 170.408 1144 209.569 1144 278.292ZM1032.92 222.239C1010.24 222.239 994.486 236.06 990.258 257.944H1075.59C1071.74 236.06 1055.6 222.239 1032.92 222.239Z" fill="#EB7310" />
                <path d="M806.429 149.693C806.429 129.101 823.123 112.408 843.715 112.408C864.307 112.408 881 129.101 881 149.693V338.788C881 362.327 861.918 381.408 838.38 381.408C825.69 381.408 813.659 375.753 805.562 365.982L699.571 238.07V344.123C699.571 364.715 682.877 381.408 662.285 381.408C641.693 381.408 625 364.715 625 344.123V155.028C625 131.49 644.082 112.408 667.62 112.408C680.31 112.408 692.341 118.063 700.438 127.835L806.429 255.747V149.693Z" fill="#EB7310" />
              </svg>
              {/* Mobile: compact logo (single pill shape) */}
              <svg
                width="600"
                height="535"
                viewBox="0 0 600 535"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
                className="block lg:hidden h-auto w-[44px] min-w-[40px]"
              >
                <path d="M345.763 0C465.611 0 525.535 0.000250731 562.768 37.2324C600 74.4646 600 134.389 600 254.237V279.844C600 399.692 600 459.616 562.768 496.849C525.535 534.081 465.611 534.081 345.763 534.081H254.237C134.389 534.081 74.4646 534.081 37.2324 496.849C0.000265896 459.616 0 399.692 0 279.844V254.237C0 134.389 0.000233878 74.4646 37.2324 37.2324C74.4646 0.000235624 134.389 0 254.237 0H345.763ZM493.881 226.834C485.761 222.635 479.685 224.166 449.823 237.938C351.09 283.475 234.021 285.385 142.896 242.946C119.241 231.928 107.443 231.868 100.82 242.729C89.6127 261.11 114.874 282.62 168.285 300.175C227.455 319.624 299.025 323.137 367.78 309.971C377.295 308.148 385.419 306.998 385.835 307.414C388.696 310.276 353.859 335.919 314.158 360.175C306.603 364.79 288.973 374.668 271.653 383.989C178.568 434.084 338.326 460.991 439.847 412.317C481.352 392.419 511.403 362.129 500.48 351.207C496.376 347.103 492.591 347.902 480.919 355.339C449.494 375.362 408.487 388.616 370.324 391.083C352.357 392.245 352.15 390.537 368.979 379.92C458.283 323.577 524.356 242.593 493.881 226.834ZM214.615 100.109C190.468 88.8647 166.849 113.544 166.849 150.022C166.849 187.721 192.117 213.08 216.749 200.1C248.08 183.589 246.617 115.013 214.615 100.109ZM416.4 99.4639C386.507 85.8092 360.234 128.272 372.204 170.897C377.957 191.385 390.288 203.224 405.87 203.225C446.478 203.225 455.209 117.191 416.4 99.4639Z" fill="#EB7310" />
              </svg>
            </LocalizedClientLink>
          </div>

          {/* Desktop Only: Center Search Bar */}
          <div className="hidden md:flex flex-1 mx-4 relative w-full ">
            <SearchBar />
          </div>

          {/* Right Group: Search (mobile), Account, Cart */}
          <div className="flex items-center gap-2 md:gap-4 flex-shrink-0">
            {/* Mobile Search Icon */}
            <div className="md:hidden">
              <SearchBar />
            </div>

            <AccountLink />
            <CartButton />
          </div>
        </div>
      </div>
    </div>
  )
}

export default TopHeader

